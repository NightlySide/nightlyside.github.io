<!DOCTYPE html>
<html lang="fr">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

    <!-- Favicon -->
    <link rel="icon" href="https://nightlyside.github.io/new/blog/theme/favicon.ico" />
    <link rel="icon" type="image/png" href="https://nightlyside.github.io/new/blog/theme/favicon.png" />

    <!-- Browser Color -->
 <meta name="author" content="Alexandre Froehlich" />
<meta name="description" content="Lettre de M. X : À ma chère famille, Ave, Si vous recevez cette lettre, c&#39;est qu&#39;il m&#39;est arrivé quelque chose. J&#39;imagine, avide d&#39;argent comme vous êtes, que vous souhaitez plutôt mettre la main sur ma fortune plutôt que de dépenser votre énergie pour me retrouver. Celà ne m&#39;arrange pas car …" />
<meta name="keywords" content="writeup, btc, cyber, python" />

    <title>[BTC] Warm Up - WriteUp
 | Alexandre Froehlich</title>

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/new/blog/theme/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/new/blog/theme/css/fontawesome.css" />
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/new/blog/theme/css/pygments/default.css">
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/new/blog/theme/css/blog.css" />

    <!-- Javascript -->
    <script src="https://nightlyside.github.io/new/blog/theme/js/jquery.js"></script>
    <script src="https://nightlyside.github.io/new/blog/theme/js/bootstrap.js"></script>
    <script src="https://nightlyside.github.io/new/blog/theme/js/fontawesome.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
</head>

<body>
    <!--
  _   _ _       _     _   _           _     _      
 | \ | (_) __ _| |__ | |_| |_   _ ___(_) __| | ___ 
 |  \| | |/ _` | '_ \| __| | | | / __| |/ _` |/ _ \
 | |\  | | (_| | | | | |_| | |_| \__ \ | (_| |  __/
 |_| \_|_|\__, |_| |_|\__|_|\__, |___/_|\__,_|\___|
          |___/             |___/                  
-->
    <div class="container-fluid">
        <div class="row">
            <!-- Fixed nav section -->
            <div class="about col-sm-12 col-md-3 col-lg-2">
                <nav class="navbar navbar-fixed-side sticky-top row">
                    <img src="https://nightlyside.github.io/new/blog/images/avatar.png" alt="Alexandre Froehlich" />
                    <h2 class="col-sm-12"><a href="https://nightlyside.github.io/new/blog/">Alexandre Froehlich</a></h2>
                    <p class="col-sm-12">
                        Hobbyist programmer. Petit développeur indépendant (aka.
                        Nightlyside) dont le rêve est d’être capable de publier un projet
                        terminé. Actuellement étudiant à l'ENSTA Bretagne
                    </p>

                    <!-- Navigation -->
                    <ul class="nav-list">
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/new/blog/">Accueil</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/new/blog/files/cv.pdf">CV</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/new/blog/categories">Catégories</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/new/blog/archives">Archives</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="#">À propos</a>
                        </li>
                    </ul>

                    <!-- Social links -->
                    <ul class="social">
                        <a href="https://github.com/nightlyside">
                            <li><i class="fab fa-github-square"></i></li>
                        </a>
                        <a href="https://www.linkedin.com/in/alexandre-f-1102298a">
                            <li><i class="fab fa-linkedin"></i></li>
                        </a>
                        <a href="https://twitter.com/froalexandre">
                            <li><i class="fab fa-twitter-square"></i></li>
                        </a>
                        <a href="https://reddit.com/u/nightlyside">
                            <li><i class="fab fa-reddit-square"></i></li>
                        </a>
                    </ul>
                </nav>
            </div>
            <!-- Main content -->
            <div class="col-sm-12 col-md-9 col-lg-10 main">
<img class="featured_image" src="https://nightlyside.github.io/new/blog/images/BTC/lettre_cryptee.jpg" alt="Image de l'article">
                <div class="container content">
                    <!-- Insert content here -->

<h1 class="title">[BTC] Warm Up - WriteUp</h1>
<p class="sous-titre">
    <span class="date-poste">Posté le dim. 05 janvier 2020 dans <a href="https://nightlyside.github.io/new/blog/category/writeups.html">writeups</a></span> <br>
    <span class="temps-lecture">Temps de lecture : 3 minutes</span>
</p>

<hr>
<p><em>Lettre de M. X :</em></p>
<p>À ma chère famille,</p>
<p>Ave,</p>
<!--summary-->

<p>Si vous recevez cette lettre, c'est qu'il m'est arrivé quelque chose.
J'imagine, avide d'argent comme vous êtes, que vous souhaitez plutôt mettre la main sur ma fortune plutôt que de dépenser votre énergie pour me retrouver.
Celà ne m'arrange pas car j'aimerai plutôt être secouru. Enfin, vous savez comme je suis prévoyant, j'ai tout prévu.</p>
<p>En échange de prévenir les forces de l'ordre, je vous propose le contenu de mon portefeuille numérique. Aujourd'hui, il devrait être valorisé à plusieurs millions si le cours ne s'est pas effondré.</p>
<!-- more -->

<p>Je vous lègue cette clé U.S.B où j'ai dissimulé plusieurs énigmes menant à des framgents qui vous permettront de reconstituer ma clé privée vous permettant d'accéder à ce portefeuille. Pour aider les enquêteurs, j'y ai également introduis plusieurs éléments sur où je me trouvais et avec qui je me trouvais avant que cette clé ne soit envoyée. Pour être sûr que vous contactiez réellement les forces de l'ordre, toute information est cachée. Je doute que vous parviendrez par vous-mêmes à résoudre une quelconque de ces énigmes, alors entourez-vous des meilleurs enquêteurs.</p>
<p>Pour commencer, je vous propose de déchiffrer le contenu du message que je vous ai laissé (encrypted.txt).
Sachez que César, à son époque, utilisait ce même système pour communiquer avec ses généraux. Je n'ai pas changé la clé, mais l'alphabet est bien différent. Et il pourrait bien être juste sous vos yeux.</p>
<p>M. X</p>
<hr />
<p>Le Challenge Break the Code est une compétition du type Capture The Flag (CTF) organisée par <a href="https://www.soprasteria.com/fr">Sopra Steria</a> qui dure 1h30. Les équipes des grandes écoles du bassin brestois s’y affrontent sur des challenges informatiques. Ces challenges mélangent différentes compétences telles que la programmation, l’analyse de donnée et la culture du numérique.  </p>
<h2>Première Analyse</h2>
<p>Ce premier exercice permettait pendant la compétition de débloquer les challenges suivants. Il était donc primordial de le réussir le plus rapidement possible de manière à gagner un maximum de temps et de points.  </p>
<blockquote>
<p>Si vous voulez essayer par vous-même, les fichiers de cet exercice sont <a href="https://nightlyside.github.io/new/blog/files/BTC/warm-up.zip">disponibles ici</a>.  </p>
</blockquote>
<p>Le contenu de l'exercice est composé d'un fichier README.md et d'un texte encrypté : </p>
<div class="highlight"><pre><span></span><span class="n">ZURAS</span> <span class="n">NLYUG</span> <span class="n">YEFPYIYPUG</span><span class="p">,</span> <span class="n">MY</span> <span class="n">HSPIY</span> <span class="n">FPY</span> <span class="n">CR</span> <span class="n">JRCQXXY</span> <span class="n">RQI</span> <span class="n">UYPGGQ</span> <span class="n">YXXY</span> <span class="n">CYCY</span> <span class="n">R</span> <span class="n">HYNLQJJUYU</span> <span class="n">NY</span> <span class="n">CYGGRKY</span><span class="p">,</span> <span class="n">N</span> <span class="n">YGI</span> <span class="n">DSPUFPSQ</span> <span class="n">MY</span> <span class="n">ASPG</span> <span class="n">JYXQNQIY</span> <span class="n">DYUGSEEYXXYCYEI</span><span class="p">.</span>

<span class="n">MY</span> <span class="n">GPQG</span> <span class="n">YCZYIY</span><span class="p">,</span> <span class="n">MY</span> <span class="n">EY</span> <span class="n">DYPB</span> <span class="n">HYASQXYU</span> <span class="n">R</span> <span class="n">CR</span> <span class="n">JRCQXXY</span> <span class="n">X</span> <span class="n">RJJRQUY</span> <span class="n">GPU</span> <span class="n">XRFPYXXY</span> <span class="n">MY</span> <span class="n">GPQG</span><span class="p">.</span>
<span class="n">CRQG</span> <span class="n">MY</span> <span class="n">GPQG</span> <span class="n">RPMSPUH</span> <span class="n">LPQ</span> <span class="n">QENRDRZXY</span> <span class="n">HY</span> <span class="n">CY</span> <span class="n">XQZYUYU</span> <span class="n">HY</span> <span class="n">X</span> <span class="n">YEHUSQI</span> <span class="n">SP</span> <span class="n">MY</span> <span class="n">GPQG</span><span class="p">.</span> 
<span class="n">DSPU</span> <span class="n">NSEARQENUY</span> <span class="n">CR</span> <span class="n">JRCQXXY</span> <span class="n">HY</span> <span class="k">C</span> <span class="n">RQHYU</span> <span class="n">YI</span> <span class="n">HY</span> <span class="n">JQERENYU</span> <span class="n">X</span> <span class="n">YEFPYIY</span> <span class="n">DSPU</span> <span class="n">CY</span> <span class="n">UYIUSPAYU</span><span class="p">,</span> <span class="n">M</span> <span class="n">RQ</span> <span class="n">HQGGQCPXYU</span> <span class="n">FPRIUY</span> <span class="n">JURKCYEIG</span> <span class="n">HY</span> <span class="n">NXY</span> <span class="n">DYUCYIIREI</span> <span class="n">HY</span> <span class="n">UYNSEGIQIPYU</span> <span class="n">XR</span> <span class="n">NXY</span> <span class="n">JQERXY</span><span class="p">.</span>
<span class="n">NYG</span> <span class="n">JURKCYEIG</span> <span class="n">GSEI</span> <span class="n">NSEIYEPG</span> <span class="n">DRU</span> <span class="n">XYG</span> <span class="n">YEQKCYG</span> <span class="n">DUYGYEIYG</span> <span class="n">HREG</span> <span class="n">XR</span> <span class="n">NXY</span> <span class="n">PGZ</span> <span class="n">FPY</span> <span class="n">MY</span> <span class="n">ASPG</span> <span class="n">RQ</span> <span class="n">RHUYGGYY</span><span class="p">.</span>
<span class="n">DSPU</span> <span class="n">ASPG</span> <span class="n">RQHYT</span> <span class="n">HREG</span> <span class="n">X</span> <span class="n">YEFPYIY</span><span class="p">,</span> <span class="n">M</span> <span class="n">RQ</span> <span class="n">YKRXYCYEI</span> <span class="n">HQGGQCPXYU</span> <span class="n">XY</span> <span class="n">XQYP</span><span class="p">,</span> <span class="n">X</span> <span class="n">QHYEIQIY</span> <span class="n">YI</span> <span class="n">XY</span> <span class="n">EPCYUS</span> <span class="n">HY</span> <span class="n">IYXYDLSEY</span> <span class="n">HY</span> <span class="n">XR</span> <span class="n">DYUGSEEY</span> <span class="n">RAYN</span> <span class="n">FPQ</span> <span class="n">M</span> <span class="n">RARQG</span> <span class="n">UYEHYT</span> <span class="n">ASPG</span><span class="p">.</span>

<span class="n">XR</span> <span class="n">NXY</span> <span class="n">PGZ</span> <span class="n">YGI</span> <span class="n">AYUUSPQXXYY</span> <span class="n">ASQNQ</span> <span class="n">XY</span> <span class="n">JXRK</span> <span class="n">DYUCYIIREI</span> <span class="n">HY</span> <span class="n">X</span> <span class="n">SPAUQU</span> <span class="n">SDYEILRIDREHSURZSB</span><span class="p">.</span>

<span class="n">ESIY</span> <span class="p">:</span> <span class="n">NYNQ</span> <span class="n">YGI</span> <span class="n">XR</span> <span class="n">UYDSEGY</span> <span class="n">FPY</span> <span class="n">ASPG</span> <span class="n">HYAYT</span> <span class="n">HSEEYU</span> <span class="n">RP</span> <span class="n">MPKY</span><span class="p">,</span> <span class="n">NY</span> <span class="n">JXRK</span> <span class="n">DYUCYI</span> <span class="n">YKRXYCYEI</span> <span class="n">HY</span> <span class="n">HYAYUSPQXXYU</span> <span class="n">XY</span> <span class="n">JQNLQYU</span> <span class="n">TQD</span> <span class="n">PGZNSEIYEIG</span><span class="p">.</span>
</pre></div>


<p>La suite du fichier README nous explique comment fonctionne le chiffrement par substitution. Si vous ne savez pas ce que c'est je vous invite à lire <a href="http://bibmath.net/crypto/index.php?action=affiche&amp;quoi=substi/defsub">cet article</a>. 
Ensuite est venue ma première erreur. Le document parle de chiffrement par décalage d'alphabet, j'ai évidemment pensé tout de suite au <a href="https://fr.wikipedia.org/wiki/Chiffrement_par_décalage">chiffre de César</a>.  </p>
<p><strong>Petite astuce</strong> : pour cracker un code chiffré par décalage du type chiffre de César, de nombreux sites web permettent de "bruteforcer" le code. Vous pourrez par exemple prendre <a href="https://www.dcode.fr/chiffre-cesar">dcode.fr</a>.</p>
<p>En testant le code crypté ci-dessus sur ces sites on ne trouve rien de cohérent, rien de lisible. C'est là que j'ai repéré mon erreur.</p>
<h2>Deuxième analyse et implémentation</h2>
<p>Comment faire pour cracker un code chiffré par substitution lorsqu'on ne connait par le nouvel alphabet ? C'est simple si le texte est assez long (et c'est le cas ici), on a juste besoin de connaitre la <a href="https://fr.wikipedia.org/wiki/Fr%C3%A9quence_d%27apparition_des_lettres_en_fran%C3%A7ais">fréquence d'apparition des lettres en français</a>.</p>


<!-- Footer -->
<hr>
<div class="container">
    <div class="row justify-content-sm-center">
        <p>© 2020 Alexandre Froehlich</p>
    </div>
</div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
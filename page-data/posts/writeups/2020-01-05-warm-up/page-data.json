{"componentChunkName":"component---src-templates-post-tsx","path":"/posts/writeups/2020-01-05-warm-up","result":{"data":{"site":{"siteMetadata":{"title":"Alexandre Froehlich"}},"markdownRemark":{"id":"e3cb5e9a-3c87-579c-83ae-27b53b0b989b","excerpt":"Lettre de M. X : À ma chère famille, Ave, Si vous recevez cette lettre, c’est qu’il m’est arrivé quelque chose. J’imagine, avide d’argent comme vous êtes, que vous souhaitez plutôt mettre la main sur ma fortune plutôt que de dépenser votre énergie pour me retrouver. Celà ne m’arrange pas car j’aimerai plutôt être secouru. Enfin, vous savez comme je suis prévoyant, j’ai tout prévu. En échange de prévenir les forces de l’ordre, je vous propose le contenu de mon portefeuille numérique. Aujourd’hui, il devrait être valorisé à plusieurs millions si le cours ne s’est pas effondré. Je vous lègue cette clé U.S.B où j’ai dissimulé plusieurs énigmes menant à des framgents qui vous permettront de reconstituer ma clé privée vous permettant d’accéder à ce portefeuille. Pour aider les enquêteurs, j’y ai également introduis plusieurs éléments sur où je me trouvais et avec qui je me trouvais avant que cette clé ne soit envoyée. Pour être sûr que vous contactiez réellement les forces de l’ordre, toute information est cachée. Je doute que vous parviendrez par vous-mêmes à résoudre une quelconque de ces énigmes, alors entourez-vous des meilleurs enquêteurs. Pour commencer, je vous propose de déchiffrer le contenu du message que je vous ai laissé (encrypted.txt). Sachez que César, à son époque, utilisait ce même système pour communiquer avec ses généraux. Je n’ai pas changé la clé, mais l’alphabet est bien différent. Et il pourrait bien être juste sous vos yeux. M. X Le Challenge Break the Code est une compétition du type Capture The Flag (CTF) organisée par Sopra Steria qui dure 1h30. Les équipes des grandes écoles du bassin brestois s’y affrontent sur des challenges informatiques. Ces challenges mélangent différentes compétences telles que la programmation, l’analyse de donnée et la culture du numérique. Première Analyse Ce premier exercice permettait pendant la compétition de débloquer les challenges suivants. Il était donc primordial de le réussir le plus rapidement possible de manière à gagner un maximum de temps et de points. Si vous voulez essayer par vous-même, les fichiers de cet exercice sont disponibles ici. Le contenu de l’exercice est composé d’un fichier README.md et d’un texte encrypté : La suite du fichier README nous explique comment fonctionne le chiffrement par substitution. Si vous ne savez pas ce que c’est je vous invite à lire cet article. Ensuite est venue ma première erreur. Le document parle de chiffrement par décalage d’alphabet, j’ai évidemment…","tableOfContents":"<ul>\n<li><a href=\"/writeups/2020-01-05-warm-up/#premi%C3%A8re-analyse\">Première Analyse</a></li>\n<li>\n<p><a href=\"/writeups/2020-01-05-warm-up/#deuxi%C3%A8me-analyse-et-impl%C3%A9mentation\">Deuxième analyse et implémentation</a></p>\n<ul>\n<li><a href=\"/writeups/2020-01-05-warm-up/#affichage\">Affichage</a></li>\n<li><a href=\"/writeups/2020-01-05-warm-up/#remplissage-du-dictionnaire\">Remplissage du dictionnaire</a></li>\n</ul>\n</li>\n<li><a href=\"/writeups/2020-01-05-warm-up/#conclusion\">Conclusion</a></li>\n</ul>","timeToRead":8,"html":"<p>Lettre de M. X :</p>\n<p><em>À ma chère famille,</em></p>\n<p><em>Ave,</em></p>\n<p><em>Si vous recevez cette lettre, c’est qu’il m’est arrivé quelque chose. J’imagine, avide d’argent comme vous êtes, que vous souhaitez plutôt mettre la main sur ma fortune plutôt que de dépenser votre énergie pour me retrouver. Celà ne m’arrange pas car j’aimerai plutôt être secouru. Enfin, vous savez comme je suis prévoyant, j’ai tout prévu.</em></p>\n<p><em>En échange de prévenir les forces de l’ordre, je vous propose le contenu de mon portefeuille numérique. Aujourd’hui, il devrait être valorisé à plusieurs millions si le cours ne s’est pas effondré.</em></p>\n<p><em>Je vous lègue cette clé U.S.B où j’ai dissimulé plusieurs énigmes menant à des framgents qui vous permettront de reconstituer ma clé privée vous permettant d’accéder à ce portefeuille. Pour aider les enquêteurs, j’y ai également introduis plusieurs éléments sur où je me trouvais et avec qui je me trouvais avant que cette clé ne soit envoyée. Pour être sûr que vous contactiez réellement les forces de l’ordre, toute information est cachée. Je doute que vous parviendrez par vous-mêmes à résoudre une quelconque de ces énigmes, alors entourez-vous des meilleurs enquêteurs.</em></p>\n<p><em>Pour commencer, je vous propose de déchiffrer le contenu du message que je vous ai laissé (encrypted.txt). Sachez que César, à son époque, utilisait ce même système pour communiquer avec ses généraux. Je n’ai pas changé la clé, mais l’alphabet est bien différent. Et il pourrait bien être juste sous vos yeux.</em></p>\n<p>M. X</p>\n<blockquote>\n<p>Le Challenge Break the Code est une compétition du type Capture The Flag (CTF) organisée par <a href=\"https://www.soprasteria.com/fr\">Sopra Steria</a> qui dure 1h30. Les équipes des grandes écoles du bassin brestois s’y affrontent sur des challenges informatiques. Ces challenges mélangent différentes compétences telles que la programmation, l’analyse de donnée et la culture du numérique.</p>\n</blockquote>\n<h2 id=\"première-analyse\" style=\"position:relative;\"><a href=\"#premi%C3%A8re-analyse\" aria-label=\"première analyse permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Première Analyse</h2>\n<p>Ce premier exercice permettait pendant la compétition de débloquer les challenges suivants. Il était donc primordial de le réussir le plus rapidement possible de manière à gagner un maximum de temps et de points.</p>\n<blockquote>\n<p>Si vous voulez essayer par vous-même, les fichiers de cet exercice sont <a href=\"/d45b731b0691df7335d2935b2b4e0081/warm-up.zip\">disponibles ici</a>.</p>\n</blockquote>\n<p>Le contenu de l’exercice est composé d’un fichier README.md et d’un texte encrypté :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ZURAS NLYUG YEFPYIYPUG, MY HSPIY FPY CR JRCQXXY RQI UYPGGQ YXXY CYCY R HYNLQJJUYU NY CYGGRKY, N YGI DSPUFPSQ MY ASPG JYXQNQIY DYUGSEEYXXYCYEI.\n\nMY GPQG YCZYIY, MY EY DYPB HYASQXYU R CR JRCQXXY X RJJRQUY GPU XRFPYXXY MY GPQG.\nCRQG MY GPQG RPMSPUH LPQ QENRDRZXY HY CY XQZYUYU HY X YEHUSQI SP MY GPQG.\nDSPU NSEARQENUY CR JRCQXXY HY C RQHYU YI HY JQERENYU X YEFPYIY DSPU CY UYIUSPAYU, M RQ HQGGQCPXYU FPRIUY JURKCYEIG HY NXY DYUCYIIREI HY UYNSEGIQIPYU XR NXY JQERXY.\nNYG JURKCYEIG GSEI NSEIYEPG DRU XYG YEQKCYG DUYGYEIYG HREG XR NXY PGZ FPY MY ASPG RQ RHUYGGYY.\nDSPU ASPG RQHYT HREG X YEFPYIY, M RQ YKRXYCYEI HQGGQCPXYU XY XQYP, X QHYEIQIY YI XY EPCYUS HY IYXYDLSEY HY XR DYUGSEEY RAYN FPQ M RARQG UYEHYT ASPG.\n\nXR NXY PGZ YGI AYUUSPQXXYY ASQNQ XY JXRK DYUCYIIREI HY X SPAUQU SDYEILRIDREHSURZSB.\n\nESIY : NYNQ YGI XR UYDSEGY FPY ASPG HYAYT HSEEYU RP MPKY, NY JXRK DYUCYI YKRXYCYEI HY HYAYUSPQXXYU XY JQNLQYU TQD PGZNSEIYEIG.</code></pre></div>\n<p>La suite du fichier README nous explique comment fonctionne le chiffrement par substitution. Si vous ne savez pas ce que c’est je vous invite à lire <a href=\"http://bibmath.net/crypto/index.php?action=affiche&#x26;quoi=substi/defsub\">cet article</a>. Ensuite est venue ma première erreur. Le document parle de chiffrement par décalage d’alphabet, j’ai évidemment pensé tout de suite au <a href=\"https://fr.wikipedia.org/wiki/Chiffrement_par_d%C3%A9calage\">chiffre de César</a>.</p>\n<p><strong>Petite astuce</strong> : pour cracker un code chiffré par décalage du type chiffre de César, de nombreux sites web permettent de “bruteforcer” le code. Vous pourrez par exemple prendre <a href=\"https://www.dcode.fr/chiffre-cesar\">dcode.fr</a>.</p>\n<p>En testant le code crypté ci-dessus sur ces sites on ne trouve rien de cohérent, rien de lisible. C’est là que j’ai repéré mon erreur.</p>\n<h2 id=\"deuxième-analyse-et-implémentation\" style=\"position:relative;\"><a href=\"#deuxi%C3%A8me-analyse-et-impl%C3%A9mentation\" aria-label=\"deuxième analyse et implémentation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deuxième analyse et implémentation</h2>\n<p>Comment faire pour cracker un code chiffré par substitution lorsqu’on ne connaît par le nouvel alphabet ? C’est simple si le texte est assez long (et c’est le cas ici), on a juste besoin de connaître la <a href=\"https://fr.wikipedia.org/wiki/Fr%C3%A9quence_d%27apparition_des_lettres_en_fran%C3%A7ais\">fréquence d’apparition des lettres en français</a>.</p>\n<h3 id=\"affichage\" style=\"position:relative;\"><a href=\"#affichage\" aria-label=\"affichage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Affichage</h3>\n<p>De manière naïve, le plus simple pour trouver un message est d’afficher graphiquement ce que l’on a déjà trouvé. Pour ce faire, on représentera les lettres que l’on a déjà trouvé. Les caractères spéciaux tels que l’espace, les apostrophes seront aussi représentés tels quels. Enfin les caractère que l’on ne connaît pas seront remplacés par des _.</p>\n<p>Au point de vue code python cela donne ceci :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">affiche_decrypt</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> trouve<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    res <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token keyword\">for</span> char <span class=\"token keyword\">in</span> msg<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># Si on connait la traduction</span>\n        <span class=\"token keyword\">if</span> char <span class=\"token keyword\">in</span> trouve<span class=\"token punctuation\">:</span>\n            res <span class=\"token operator\">+=</span> trouve<span class=\"token punctuation\">[</span>char<span class=\"token punctuation\">]</span>\n        <span class=\"token comment\"># Si le caractère fait partie des spéciaux</span>\n        <span class=\"token keyword\">elif</span> char <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\",\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\":\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n            res <span class=\"token operator\">+=</span> char\n        <span class=\"token comment\"># Sinon on ne le connait pas</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            res <span class=\"token operator\">+=</span> <span class=\"token string\">\"_\"</span>\n    <span class=\"token comment\"># On retourne le texte formatté</span>\n    <span class=\"token keyword\">return</span> res</code></pre></div>\n<p>On n’oublie juste pas de prendre en compte le fait que <code class=\"language-text\">trouve</code> est un dictionnaire dont chaque clé correspond à la lettre substituée.</p>\n<h3 id=\"remplissage-du-dictionnaire\" style=\"position:relative;\"><a href=\"#remplissage-du-dictionnaire\" aria-label=\"remplissage du dictionnaire permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Remplissage du dictionnaire</h3>\n<p>Pour savoir quelle lettre est la plus fréquente dans le message, on crée une petite fonction python :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">occurrences</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># On crée le dictionnaire des occurences</span>\n    <span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># Pour chaque lettre dans le message</span>\n    <span class=\"token keyword\">for</span> char <span class=\"token keyword\">in</span> msg<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># S'il s'agit bien d'une lettre</span>\n        <span class=\"token keyword\">if</span> char <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\",\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\":\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># Si on a déjà crée une occurence</span>\n            <span class=\"token keyword\">if</span> char <span class=\"token keyword\">in</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n                <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span>char<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span>char<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n    <span class=\"token comment\"># On retourne les lettres triées par occurrences</span>\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">,</span> key<span class=\"token operator\">=</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">,</span> reverse<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Par exemple pour le message crypté donné on obtient :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span><span class=\"token string\">'Y'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'U'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'G'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Q'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'P'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'E'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'S'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'C'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'J'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'M'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'F'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'K'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Z'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'L'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'T'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'B'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Ainsi en essayant <code class=\"language-text\">Y=E</code>, <code class=\"language-text\">R=A</code>, <code class=\"language-text\">U=I</code>, <code class=\"language-text\">G=S</code>, <code class=\"language-text\">X=N</code> sur le message crypté on obtient :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">_IA__ __EIS E___E_E_IS, _E ____E __E _A _A__NNE A__ IE_SS_ ENNE _E_E A _E_____IEI _E _ESSA_E, _ ES_ ___I____ _E ___S _EN____E _EIS___ENNE_E__.\n\n_E S__S E__E_E, _E _E _E__ _E___NEI A _A _A__NNE N A__A_IE S_I NA__ENNE _E S__S.\n_A_S _E S__S A____I_ ___ ___A_A_NE _E _E N__EIEI _E N E__I___ __ _E S__S.\n___I ____A___IE _A _A__NNE _E _ A__EI E_ _E ___A__EI N E___E_E ___I _E IE_I___EI, _ A_ __SS___NEI __A_IE _IA__E__S _E _NE _EI_E__A__ _E IE___S____EI NA _NE ___ANE.\n_ES _IA__E__S S___ ____E__S _AI NES E____ES _IESE__ES _A_S NA _NE _S_ __E _E ___S A_ A_IESSEE.\n___I ___S A__E_ _A_S N E___E_E, _ A_ E_ANE_E__ __SS___NEI NE N_E_, N __E____E E_ NE ___EI_ _E _ENE____E _E NA _EIS___E A_E_ ___ _ A_A_S IE__E_ ___S.\n\nNA _NE _S_ ES_ _EII___NNEE _____ NE _NA_ _EI_E__A__ _E N ___I_I __E___A__A___IA___.\n\n___E : _E__ ES_ NA IE___SE __E ___S _E_E_ ____EI A_ ___E, _E _NA_ _EI_E_ E_ANE_E__ _E _E_EI___NNEI NE _____EI ___ _S_____E__S.</code></pre></div>\n<p>C’est effectivement un bon premier départ. Certes, cela ne marche pas pour toutes les lettres cependant on peut commencer à deviner les mots. De plus s’agissant d’une lettre on devine que le mot du dernier paragraphe <code class=\"language-text\">ESIY</code> : correspond à <code class=\"language-text\">NOTE</code> : en essayant petit à petit on arrive à remplir le dictionnaire :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">trouve <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"Y\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"E\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"R\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"U\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"R\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"G\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"S\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"X\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"L\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"E\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"N\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"S\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"O\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"I\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"T\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"C\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"M\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"D\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"P\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"H\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"D\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"P\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"U\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"J\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"F\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Q\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"I\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"N\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"C\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"F\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Q\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"V\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"T\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"L\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"H\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"K\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"G\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"B\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"M\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"J\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"B\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"X\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ce qui nous donne enfin le message décrypté :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">BRAVO CHERS ENQUETEURS, JE DOUTE QUE MA FAMILLE AIT REUSSI ELLE MEME A DECHIFFRER CE MESSAGE, C EST POURQUOI JE VOUS FELICITE PERSONNELLEMENT.\n\nJE SUIS EMBETE, JE NE PEUX DEVOILER A MA FAMILLE L AFFAIRE SUR LAQUELLE JE SUIS.\nMAIS JE SUIS AUJOURD HUI INCAPABLE DE ME LIBERER DE L ENDROIT OU JE SUIS.\nPOUR CONVAINCRE MA FAMILLE DE M AIDER ET DE FINANCER L ENQUETE POUR ME RETROUVER, J AI DISSIMULER QUATRE FRAGMENTS DE CLE PERMETTANT DE RECONSTITUER LA CLE FINALE.\nCES FRAGMENTS SONT CONTENUS PAR LES ENIGMES PRESENTES DANS LA CLE USB QUE JE VOUS AI ADRESSEE.\nPOUR VOUS AIDEZ DANS L ENQUETE, J AI EGALEMENT DISSIMULER LE LIEU, L IDENTITE ET LE NUMERO DE TELEPHONE DE LA PERSONNE AVEC QUI J AVAIS RENDEZ VOUS.\n\nLA CLE USB EST VERROUILLEE VOICI LE FLAG PERMETTANT DE L OUVRIR OPENTHATPANDORABOX.\n\nNOTE : CECI EST LA REPONSE QUE VOUS DEVEZ DONNER AU JUGE, CE FLAG PERMET EGALEMENT DE DEVEROUILLER LE FICHIER ZIP USBCONTENTS.</code></pre></div>\n<p>On récupère finalement le flag qui est <code class=\"language-text\">OPENTHATPANDORABOX</code>.</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>Ce challenge permettait de débloquer les 7 derniers de la compétition. Leur résolution était primordiale. Le dossier <em>usb</em>contents_ présent sur la clé se déverrouille ainsi avec le flag obtenu.\nLes organisateurs ont finalement distribué le flag aux autres équipes en donnant un indice qui me fait penser encore que les combinaisons les plus simples sont malheureusement encore (trop) souvent utilisées dans les concours. Si vous remplacez “ABCDEFG…” par “AZERTYU…” vous obtenez le déchiffrage.\nMon erreur aura été ici d’avoir perdu trop de temps en pensant qu’il n’y avait pas de pattern possible pour la substitution. Je m’en souviendrais !</p>\n<p>PS : pour les flemmards voici une fonction python qui vous sort la prochaine lettre la plus fréquente en fonction du message et de ce que vous avez déjà deviné :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">prochaine_lettre</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> trouve<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># On recupere les occurences</span>\n    occ <span class=\"token operator\">=</span> occurrences<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Pour chaque lettre à partir de la plus récurrente</span>\n    <span class=\"token keyword\">for</span> lettre <span class=\"token keyword\">in</span> occ<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># Si la lettre n'a pas été trouvée</span>\n        <span class=\"token keyword\">if</span> lettre <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> trouve<span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># On retourne la lettre</span>\n            <span class=\"token keyword\">return</span> lettre\n    <span class=\"token comment\"># Toutes les lettres ont été testées</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">None</span></code></pre></div>\n<p>PPS: pour les plus flemmard vous pouvez retrouver le code au complet <a href=\"/b7c020b59994eaa24a8a991172edb84e/pandora_box.py\">ici</a>.</p>","frontmatter":{"date":"January 05, 2020","title":"[BTC] Warm Up - WriteUp","slug":null,"tags":["writeup","break-the-code","challenge","CTF"],"layout":"post","published":true,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABy1CVD//EABYQAQEBAAAAAAAAAAAAAAAAAAAREP/aAAgBAQABBQLYiP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQADAQEAAAAAAAAAAAAAAAARIVEBgf/aAAgBAQABPyGlPeoYhiGP/9oADAMBAAIAAwAAABAwz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAECBwAAAAAAAAAAAAAAAAEAISAxQVFxkfH/2gAIAQEAAT8QAvL5ZS1O0RwMG2//2Q==","aspectRatio":1.7699115044247788,"src":"/static/6d07ac3c7f431eab594b65cb820721fa/14b42/lettre_cryptee.jpg","srcSet":"/static/6d07ac3c7f431eab594b65cb820721fa/f836f/lettre_cryptee.jpg 200w,\n/static/6d07ac3c7f431eab594b65cb820721fa/2244e/lettre_cryptee.jpg 400w,\n/static/6d07ac3c7f431eab594b65cb820721fa/14b42/lettre_cryptee.jpg 800w,\n/static/6d07ac3c7f431eab594b65cb820721fa/47498/lettre_cryptee.jpg 1200w,\n/static/6d07ac3c7f431eab594b65cb820721fa/0e329/lettre_cryptee.jpg 1600w,\n/static/6d07ac3c7f431eab594b65cb820721fa/d8255/lettre_cryptee.jpg 1920w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"headings":[{"value":"Première Analyse","depth":2,"id":"première-analyse"},{"value":"Deuxième analyse et implémentation","depth":2,"id":"deuxième-analyse-et-implémentation"},{"value":"Affichage","depth":3,"id":"affichage"},{"value":"Remplissage du dictionnaire","depth":3,"id":"remplissage-du-dictionnaire"},{"value":"Conclusion","depth":2,"id":"conclusion"}]}},"pageContext":{"slug":"writeups/2020-01-05-warm-up","previous":{"fields":{"slug":"writeups/2020-01-01-btc-morse"},"frontmatter":{"tags":["writeup","break-the-code","challenge","CTF"],"title":"[BTC] L'Histoire sans fin - WriteUp","date":"2020-01-01T12:00:00.000Z","slug":null,"layout":"post","published":true}},"next":{"fields":{"slug":"2020-06-26-chatbot-vocal"},"frontmatter":{"tags":["python","web","api"],"title":"Un chatbot vocal en python","date":"2020-06-26T12:00:00.000Z","slug":null,"layout":"post","published":true}}}},"staticQueryHashes":["3433897746","712016698","781468736"]}
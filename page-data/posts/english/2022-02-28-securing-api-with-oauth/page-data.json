{"componentChunkName":"component---src-templates-post-tsx","path":"/posts/english/2022-02-28-securing-api-with-oauth","result":{"data":{"site":{"siteMetadata":{"title":"Alexandre Froehlich"}},"markdownRemark":{"id":"f3d7d3e3-da59-5033-808b-2101914b4acf","excerpt":"When it comes to the design of an application protocol interface (API), some keywords crop up on the internet like REST or CRUD. However security comes last in the design process. In this post you will learn how to make your API secure, using state of the art technology in your python project. To follow this post you should know what an API is and have some experience coding with python. Make sure python 3.x in installed on your computer in order to make the following snippets work. What are web tokens? Take a second to think about your API. Perhaps you are fetching data from a specific endpoint which needs to be secured. How can you be sure the request is legitimate or the user making the request has the required rights to do so? A good practice is to use authorization tokens. To be more specific we will use Javascript Web Tokens (JWT). Javascript Web Token « JSON Web Token (JWT, pronounced /dʒɒt/, same as the word “jot”) is a proposed Internet standard for creating data with optional signature and/or optional encryption whose payload holds JSON that asserts some number of claims. » - Wikipedia In a nutshell, a JWT is a token holding information that can be verified in order to authenticate a user and their rights. This token will be sent in the header of the request or as a query argument to give context to the API. A JWT token can be broken down into three pieces, separated by a point (”.”) : an header describing the token type and the hashing algorithm used a payload with the token’s content, for example the username, the user’s role, expiration of the token, … a signature which will take the header and the payload, encoded using base64, concatenated with a secret which yields a hash to verify the authenticity of the token The signature is optional for JWT tokens to work. However, is no signature is provided, anyone can compromise and change the content carried by the token. Example For the following example, the payload will be the username, the role, the creation date and the secret will be mysupersecret. I am using jwt.io in order to deconstruct the token.  The website returns the following token : Verifying a JWT token As I wrote above, a JWT token can be verified to be sure the payload has not been modified by an attacker. To verify the token, the server has to know the secret, so that the signature can be recreated on the server side and compared to the signature provided to see if the token is legitimate. Knowing the common secret, the server…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/english/2022-02-28-securing-api-with-oauth/#what-are-web-tokens\">What are web tokens?</a></p>\n<ul>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#javascript-web-token\">Javascript Web Token</a></li>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#example\">Example</a></li>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#verifying-a-jwt-token\">Verifying a JWT token</a></li>\n</ul>\n</li>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#api-boilerplate-code\">API boilerplate code</a></li>\n<li>\n<p><a href=\"/english/2022-02-28-securing-api-with-oauth/#a-jwt-implementation-in-python\">A JWT implementation in python</a></p>\n<ul>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#token-creation\">Token creation</a></li>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#verifying-a-token\">Verifying a token</a></li>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#wrap-up\">Wrap up</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/english/2022-02-28-securing-api-with-oauth/#securing-the-api\">Securing the API</a></p>\n<ul>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#building-a-small-login-endpoint\">Building a small login endpoint</a></li>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#protect-the-private-page\">Protect the private page</a></li>\n</ul>\n</li>\n<li><a href=\"/english/2022-02-28-securing-api-with-oauth/#conclusion\">Conclusion</a></li>\n</ul>","timeToRead":8,"html":"<p>When it comes to the design of an application protocol interface (<em>API</em>), some keywords crop up on the internet like REST or CRUD. However security comes last in the design process. In this post you will learn how to make your API secure, using state of the art technology in your python project.</p>\n<p>To follow this post you should know what an API is and have some experience coding with python.</p>\n<blockquote>\n<p>Make sure python 3.x in installed on your computer in order to make the following snippets work.</p>\n</blockquote>\n<h1 id=\"what-are-web-tokens\" style=\"position:relative;\"><a href=\"#what-are-web-tokens\" aria-label=\"what are web tokens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What are web tokens?</h1>\n<p>Take a second to think about your API. Perhaps you are fetching data from a specific endpoint which needs to be secured. How can you be sure the request is legitimate or the user making the request has the required rights to do so?</p>\n<p>A good practice is to use authorization tokens. To be more specific we will use Javascript Web Tokens (<em>JWT</em>).</p>\n<h2 id=\"javascript-web-token\" style=\"position:relative;\"><a href=\"#javascript-web-token\" aria-label=\"javascript web token permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Javascript Web Token</h2>\n<blockquote>\n<p>« <em>JSON Web Token (JWT, pronounced /dʒɒt/, same as the word “jot”) is a proposed Internet standard for creating data with optional signature and/or optional encryption whose payload holds JSON that asserts some number of claims.</em> » - Wikipedia</p>\n</blockquote>\n<p>In a nutshell, a JWT is a token holding information that can be verified in order to authenticate a user and their rights. This token will be sent in the header of the request or as a query argument to give context to the API.</p>\n<p>A JWT token can be broken down into three pieces, separated by a point (”.”) :</p>\n<ul>\n<li>an <strong>header</strong> describing the token type and the hashing algorithm used</li>\n<li>a <strong>payload</strong> with the token’s content, for example the username, the user’s role, expiration of the token, …</li>\n<li>a <strong>signature</strong> which will take the header and the payload, encoded using base64, concatenated with a <strong>secret</strong> which yields a hash to verify the authenticity of the token</li>\n</ul>\n<p>The signature is optional for JWT tokens to work. However, is no signature is provided, anyone can compromise and change the content carried by the token.</p>\n<h2 id=\"example\" style=\"position:relative;\"><a href=\"#example\" aria-label=\"example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example</h2>\n<p>For the following example, the payload will be the username, the role, the creation date and the secret will be <em>my</em>super<em>secret</em>. I am using <a href=\"https://jwt.io/\">jwt.io</a> in order to deconstruct the token.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1191px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.43750000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABQ0lEQVQoz4VSi26DMAzk/z+x2lSkdatUBqXBeSe+OenSUdptRocdYh3nR/d+/IDxDokzGNigvAGlFPq+xziOSCkhhICcc71j5jt0+aSQPwl5WMAS8+nqyzlRrJTBe2itEWKEk7gRPkMX3xLcQdAnGImtxEZit0+IA1eVXNS4KFKNsCd8S6uKmspilfBzZrwuGYeFMRnGIBgtwwXJSNfkKMoCGbB24JSvP+FHVEKTGZQYnlvXtp0sJQcYZ5Dbk39Hh5VV6fzT6HXMGoiTqD2LEivfw63y+5J5Nant1Nq5JLKXDpBANxI82E0hP7ldkzrnMZ0nkJYN4Cg9DTLxUKe9Rlmp7tku3avkuiq7ccH+TDheCIMiLESgDbzkdfjH2h72M2E3W7xcLI5KP5DdCP9S11DKuZDGrG2FMhbWmApTvLXVl7wvwm1gp9tkW8gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JWT example\"\n        title=\"JWT example\"\n        src=\"/static/57b716e4326d47d900a0f31f8008bb2e/19a6b/jwt_example.png\"\n        srcset=\"/static/57b716e4326d47d900a0f31f8008bb2e/72799/jwt_example.png 320w,\n/static/57b716e4326d47d900a0f31f8008bb2e/6af66/jwt_example.png 640w,\n/static/57b716e4326d47d900a0f31f8008bb2e/19a6b/jwt_example.png 1191w\"\n        sizes=\"(max-width: 1191px) 100vw, 1191px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>The website returns the following token :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRob21hc190aGVfdHJhaW4iLCJyb2xlIjoiQWRtaW4iLCJpYXQiOjE1MTYyMzkwMjJ9.jvPs4WoDqqj2fhsRmgGushRvfOq--UkZizfyZqu88bE</code></pre></div>\n<h2 id=\"verifying-a-jwt-token\" style=\"position:relative;\"><a href=\"#verifying-a-jwt-token\" aria-label=\"verifying a jwt token permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verifying a JWT token</h2>\n<p>As I wrote above, a JWT token can be verified to be sure the payload has not been modified by an attacker.</p>\n<p>To verify the token, the server has to know the secret, so that the signature can be recreated on the server side and compared to the signature provided to see if the token is legitimate.</p>\n<p>Knowing the common secret, the server hosting the API can build the signature using the base64 encoded header and payload, joined using a point, concatenating the secret and hashing the whole with the algorithm specified in the token header (here HS256).</p>\n<p>The token is legitimate if both signatures match, otherwise it has probably been modified, either maliciously or due to an error.</p>\n<h1 id=\"api-boilerplate-code\" style=\"position:relative;\"><a href=\"#api-boilerplate-code\" aria-label=\"api boilerplate code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API boilerplate code</h1>\n<p>If you do not have some kind of API to tinker with, you can grab the following code which will serve a small API with two endpoints:</p>\n<ul>\n<li><code class=\"language-text\">/public</code>: can be seen by anyone</li>\n<li><code class=\"language-text\">/private</code>: should be seen by authenticated users only</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># -- main.py --</span>\n<span class=\"token keyword\">from</span> fastapi <span class=\"token keyword\">import</span> FastAPI\napp <span class=\"token operator\">=</span> FastAPI<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/public\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">public_page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Hello, world!\"</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/private\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">private_page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"This is the private page\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>If you do not have FastAPI nor uvicorn installed, you can simply execute the following to get it :\n<code class=\"language-text\">python -m pip install FastAPI uvicorn</code></p>\n</blockquote>\n<p>You should be able to launch the API using :</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">uvicorn main:app --reload</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 664px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.5625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA20lEQVQY002P6WqEQBCEfQ3ZqHO7OvGY8ZjRNQaywub9X6jSTAjkR1FF0/3RlbFOobgr1LZBWFfMywJrWyzkQ99DcA4uBIzWkORKSiglIRhL2RiNsizxdruhKApkbH4HkxxaaWzblkALgUMIiDHiui6arTifV5p/v174/HrCU/Yhpr2maegJi5Y847ED0wJaG5znmaD7/sBxHAn4cTxQjw5mP1DTwTgMkK0Fs11SRQ2qqgInZ/R1xlyDSrAEDGHFNE3o+w5+mil7eO/QE9C5EZwO8jz/rfcnqvlfP4CEeIVy6FkRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Launching the API\"\n        title=\"Launching the API\"\n        src=\"/static/cda4f7b6944d22dc3dcaa5a175bb4f59/31493/launch_API.png\"\n        srcset=\"/static/cda4f7b6944d22dc3dcaa5a175bb4f59/72799/launch_API.png 320w,\n/static/cda4f7b6944d22dc3dcaa5a175bb4f59/6af66/launch_API.png 640w,\n/static/cda4f7b6944d22dc3dcaa5a175bb4f59/31493/launch_API.png 664w\"\n        sizes=\"(max-width: 664px) 100vw, 664px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Make sure the API is working by visiting <a href=\"http://127.0.0.1:8000/public\">http://127.0.0.1:8000/public</a> which should yield the following response :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Hello, world!\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The following section will finally implement security into the API.</p>\n<h1 id=\"a-jwt-implementation-in-python\" style=\"position:relative;\"><a href=\"#a-jwt-implementation-in-python\" aria-label=\"a jwt implementation in python permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A JWT implementation in python</h1>\n<p>Fortunately clever people made our job easier by building appropriate tools. The website <a href=\"https://jwt.io/\">jwt.io</a> provides a list of libraries implementing the JWT creation and verification process.</p>\n<blockquote>\n<p>For this post I picked <code class=\"language-text\">jwcrypto</code> for its compliance with recents RFC. You can install this library executing : <code class=\"language-text\">python -m pip install jwcrypto</code>.</p>\n</blockquote>\n<h2 id=\"token-creation\" style=\"position:relative;\"><a href=\"#token-creation\" aria-label=\"token creation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Token creation</h2>\n<p>The first step is to import the library and create our secret :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> jwcrypto <span class=\"token keyword\">import</span> jwk<span class=\"token punctuation\">,</span> jwt\n\n<span class=\"token comment\"># generating a key from a secret</span>\nkey <span class=\"token operator\">=</span> jwk<span class=\"token punctuation\">.</span>JWK<span class=\"token punctuation\">.</span>from_password<span class=\"token punctuation\">(</span><span class=\"token string\">\"my_super_secret\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># we can see the JW key content with secret.export()</span>\n<span class=\"token comment\"># {\"k\":\"bXlfc3VwZXJfc2VjcmV0\",\"kty\":\"oct\"}</span></code></pre></div>\n<p>Then we can build the header and the payload (known as “claims” as well) :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time\n\nheader <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jwt\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"alg\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"HS256\"</span>\n<span class=\"token punctuation\">}</span>\n\nclaims <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"username\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"thomas_the_train\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"role\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"exp\"</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># building the token</span>\ntoken <span class=\"token operator\">=</span> jwt<span class=\"token punctuation\">.</span>JWT<span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">,</span> claims<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># adding the signature</span>\ntoken<span class=\"token punctuation\">.</span>make_signed_token<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># making it into a string</span>\nsigned_token <span class=\"token operator\">=</span> token<span class=\"token punctuation\">.</span>serialize<span class=\"token punctuation\">(</span>compact<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Once this script is running, you should see something similar on your screen :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">eyJhbGciOiJIUzI1NiIsInR5cGUiOiJqd3QifQ.\neyJleHAiOjE2NDQ4MjgxNTAsInJvbGUiOiJhZG1pbiIsInVzZXJuYW1lIjoidGhvbWFzX3RoZV90cmFpbiJ9.\nzAS1YRrLBbhiJwI8_aycWYmc6IclooequgI6rQUsE54</code></pre></div>\n<p>If I decode this token using <a href=\"https://jwt.io/\">jwt.io</a> we get the following :</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1196px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.81250000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQoz31Si27CMAzs/3/htEmj2xCMUqCPvBP75rQEBO1wdYprJ2f75Gq730E7iwSSD+AnZFNKYVPXaJoGKUZ470FEU46ZH1DxcQQdFegwghvBYbid1JuJNIYAbQxCShNZ/s+Ea6jiV4L7TtCfCUZ8W4tfR5hNhNuTEPLcjY/AYOZzpbMSq9oTY6sJrSWcHePiGa2c2e/Fl1tI0llQBqQcOKZZjifC28iaGJbmh7MtVYwhQlsz6cxZa75ibWQUGi5V79Vx9fNjtkIs08Sz5ILE01xwMfJj+1jVJVdmD5AGkoCcxCMWNhEWZy1Z4t4HnLsLRiUbIEwpBcQYEMIjoqxUhRcCF8J8+eM0Tth1Cr+9wiC7qZ7gnLtr+J+VPfzpNN47izfBttcLshvhq+4KgowyKI3eWHTaotcGxiyRl/4PUVBgb/bh4lcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JWT decoded\"\n        title=\"JWT decoded\"\n        src=\"/static/b073b69fba211ebbe6ca7bff273ae222/51800/jwt_decoded.png\"\n        srcset=\"/static/b073b69fba211ebbe6ca7bff273ae222/72799/jwt_decoded.png 320w,\n/static/b073b69fba211ebbe6ca7bff273ae222/6af66/jwt_decoded.png 640w,\n/static/b073b69fba211ebbe6ca7bff273ae222/51800/jwt_decoded.png 1196w\"\n        sizes=\"(max-width: 1196px) 100vw, 1196px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h2 id=\"verifying-a-token\" style=\"position:relative;\"><a href=\"#verifying-a-token\" aria-label=\"verifying a token permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verifying a token</h2>\n<p>Suppose we get a token in a GET request (<em>req</em>token<em>), how can we verify its authenticity?\nAgain, _jwcrypto</em> gives us a hand to verify this piece of data.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> jwcrypto <span class=\"token keyword\">import</span> jwk<span class=\"token punctuation\">,</span> jwt\n\n<span class=\"token comment\"># generating the same key as before</span>\nkey <span class=\"token operator\">=</span> jwk<span class=\"token punctuation\">.</span>JWK<span class=\"token punctuation\">.</span>from_password<span class=\"token punctuation\">(</span><span class=\"token string\">\"my_super_secret\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># testing the key</span>\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    token <span class=\"token operator\">=</span> jwt<span class=\"token punctuation\">.</span>JWT<span class=\"token punctuation\">(</span>key<span class=\"token operator\">=</span>key<span class=\"token punctuation\">,</span> jwt<span class=\"token operator\">=</span>token_str<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># here the token is valid we can work with it</span>\n<span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># here the token is invalid, we should notice the user</span></code></pre></div>\n<h2 id=\"wrap-up\" style=\"position:relative;\"><a href=\"#wrap-up\" aria-label=\"wrap up permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wrap up</h2>\n<p>Once these concepts are familiar with you we can build two new functions to create and verify tokens. Try first by yourself then compare it with the following code :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">make_token</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> jwk<span class=\"token punctuation\">.</span>JWK<span class=\"token punctuation\">,</span> payload<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># same header for all tokens</span>\n    header <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jwt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"alg\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"HS256\"</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># building and signing the token</span>\n    token <span class=\"token operator\">=</span> jwt<span class=\"token punctuation\">.</span>JWT<span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">)</span>\n    token<span class=\"token punctuation\">.</span>make_signed_token<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># returning the token as a string</span>\n    signed_token <span class=\"token operator\">=</span> token<span class=\"token punctuation\">.</span>serialize<span class=\"token punctuation\">(</span>compact<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> signed_token\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">is_token_valid</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> jwk<span class=\"token punctuation\">.</span>JWK<span class=\"token punctuation\">,</span> token_str<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># if we manage to make a new token from the string</span>\n        <span class=\"token comment\"># then the token is legit</span>\n        _ <span class=\"token operator\">=</span> jwt<span class=\"token punctuation\">.</span>JWT<span class=\"token punctuation\">(</span>key<span class=\"token operator\">=</span>key<span class=\"token punctuation\">,</span> jwt<span class=\"token operator\">=</span>token_str<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># else the token is invalid</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></code></pre></div>\n<h1 id=\"securing-the-api\" style=\"position:relative;\"><a href=\"#securing-the-api\" aria-label=\"securing the api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Securing the API</h1>\n<h2 id=\"building-a-small-login-endpoint\" style=\"position:relative;\"><a href=\"#building-a-small-login-endpoint\" aria-label=\"building a small login endpoint permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building a small login endpoint</h2>\n<p>For this post to be reasonably short, we will hardcode some credentials into the API. You can build something similar with a database, here the users’ credentials will be a simple list :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">users <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"username\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"password\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"password\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Please, for production use stronger credentials I beg you.</p>\n<p>We continue by writing a new endpoint utilizing the previous functions we built above :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">login_page</span><span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    usernames <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>user<span class=\"token punctuation\">[</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> user <span class=\"token keyword\">in</span> users<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">if</span> username <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> usernames<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"User not in database\"</span><span class=\"token punctuation\">}</span>\n\n    user_id <span class=\"token operator\">=</span> usernames<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span>\n    user <span class=\"token operator\">=</span> users<span class=\"token punctuation\">[</span>user_id<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">if</span> user<span class=\"token punctuation\">[</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> password<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Wrong user/password combination\"</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"success\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"token\"</span><span class=\"token punctuation\">:</span> make_token<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">:</span> user<span class=\"token punctuation\">[</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"exp\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token operator\">*</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then to test this new page, go to <a href=\"http://127.0.0.1/login?username=admin&#x26;password=password\">http://127.0.0.1/login?username=admin&#x26;password=password</a>. You should be greeted with a brand new token :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"success\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"token\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eyJhbGciOiJIUzI1NiIsInR5cGUiOiJqd3QifQ.eyJleHAiOjE2NDUwMzEwNDIuNzc2MjI1LCJ1c2VyIjoiYWRtaW4ifQ.1O7QCylGL8M2dvvXSe3Q4l_c2NnxfMEHZ7Stuv4vmqo\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"protect-the-private-page\" style=\"position:relative;\"><a href=\"#protect-the-private-page\" aria-label=\"protect the private page permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Protect the private page</h2>\n<p>The last step will be to protect the private page. With no or a bad token provided, the endpoint should return an error. Without a token, or a bad token, the endpoint should return an error.</p>\n<p>For this we will be using a middleware. In a nutshell a middleware is a piece of code sitting between two processes.</p>\n<p>This middleware we are going to write, is code checking for the validity of a JWT token being provided.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/private\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">private_page</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># if there is no token or the token is invalid</span>\n    <span class=\"token keyword\">if</span> token <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">is</span> is_token_valid<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"You are not authorized\"</span>\n\n    <span class=\"token comment\"># else the user is authenticated</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"&lt;h1>Welcome to the private section of this website&lt;/h1>\"</span></code></pre></div>\n<h1 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h1>\n<p>This is everything there is to know in order to start designing and building a secure API from the ground up using as few librairies as <del>comfortably</del> possible.</p>\n<p>As of now, a delivered token does not really have any system of revocation. In the case where a token is compromised (stolen for example), anyone with this token will be able to impersonate the user.</p>\n<p>Another topic about security around token authorization is the concept of scopes, which is way beyond the goal of this article.</p>\n<p>The next article will be on token revocation using a second token called a <strong>Refresh Token</strong>.</p>","frontmatter":{"date":"February 28, 2022","title":"Securing an API using JWT and Python","slug":null,"tags":["jwt","web","security","api"],"layout":"post","published":true,"image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQoz31Si27CMAzs/3/htEmj2xCMUqCPvBP75rQEBO1wdYprJ2f75Gq730E7iwSSD+AnZFNKYVPXaJoGKUZ470FEU46ZH1DxcQQdFegwghvBYbid1JuJNIYAbQxCShNZ/s+Ea6jiV4L7TtCfCUZ8W4tfR5hNhNuTEPLcjY/AYOZzpbMSq9oTY6sJrSWcHePiGa2c2e/Fl1tI0llQBqQcOKZZjifC28iaGJbmh7MtVYwhQlsz6cxZa75ibWQUGi5V79Vx9fNjtkIs08Sz5ILE01xwMfJj+1jVJVdmD5AGkoCcxCMWNhEWZy1Z4t4HnLsLRiUbIEwpBcQYEMIjoqxUhRcCF8J8+eM0Tth1Cr+9wiC7qZ7gnLtr+J+VPfzpNN47izfBttcLshvhq+4KgowyKI3eWHTaotcGxiyRl/4PUVBgb/bh4lcAAAAASUVORK5CYII=","aspectRatio":1.8867924528301887,"src":"/static/b073b69fba211ebbe6ca7bff273ae222/ee604/jwt_decoded.png","srcSet":"/static/b073b69fba211ebbe6ca7bff273ae222/69585/jwt_decoded.png 200w,\n/static/b073b69fba211ebbe6ca7bff273ae222/497c6/jwt_decoded.png 400w,\n/static/b073b69fba211ebbe6ca7bff273ae222/ee604/jwt_decoded.png 800w,\n/static/b073b69fba211ebbe6ca7bff273ae222/7eec6/jwt_decoded.png 1196w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"headings":[{"value":"What are web tokens?","depth":1,"id":"what-are-web-tokens"},{"value":"Javascript Web Token","depth":2,"id":"javascript-web-token"},{"value":"Example","depth":2,"id":"example"},{"value":"Verifying a JWT token","depth":2,"id":"verifying-a-jwt-token"},{"value":"API boilerplate code","depth":1,"id":"api-boilerplate-code"},{"value":"A JWT implementation in python","depth":1,"id":"a-jwt-implementation-in-python"},{"value":"Token creation","depth":2,"id":"token-creation"},{"value":"Verifying a token","depth":2,"id":"verifying-a-token"},{"value":"Wrap up","depth":2,"id":"wrap-up"},{"value":"Securing the API","depth":1,"id":"securing-the-api"},{"value":"Building a small login endpoint","depth":2,"id":"building-a-small-login-endpoint"},{"value":"Protect the private page","depth":2,"id":"protect-the-private-page"},{"value":"Conclusion","depth":1,"id":"conclusion"}]}},"pageContext":{"slug":"english/2022-02-28-securing-api-with-oauth","previous":{"fields":{"slug":"devlogs/2021-04-23-introduction-rendu-3d"},"frontmatter":{"tags":["rust","3d","vulkan","game engine"],"title":"Créer son moteur de jeu 3d - Introduction","date":"2021-04-23T09:11:00.000Z","slug":null,"layout":"post","published":true}},"next":null}},"staticQueryHashes":["3433897746","712016698","781468736"]}
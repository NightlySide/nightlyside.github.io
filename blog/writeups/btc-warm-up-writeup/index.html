<!DOCTYPE html>
<html lang="fr">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

    <!-- Favicon -->
    <link rel="icon" href="https://nightlyside.github.io/blog/theme/favicon.ico" />
    <link rel="icon" type="image/png" href="https://nightlyside.github.io/blog/theme/favicon.png" />

    <!-- Browser Color -->
     <meta name="author" content="Alexandre Froehlich" />
    <meta name="description" content="Site web portfolio de Alexandre Froehlich" />

    <title>[BTC] Warm Up - WriteUp | Alexandre Froehlich
 | Alexandre Froehlich</title>

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/blog/theme/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/blog/theme/css/fontawesome.css" />
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/blog/theme/css/pygments/default.css">
    <link rel="stylesheet" type="text/css" href="https://nightlyside.github.io/blog/theme/css/blog.css" />

    <!-- Javascript -->
    <script src="https://nightlyside.github.io/blog/theme/js/jquery.js"></script>
    <script src="https://nightlyside.github.io/blog/theme/js/bootstrap.js"></script>
    <script src="https://nightlyside.github.io/blog/theme/js/fontawesome.js"></script>
    <script src="https://nightlyside.github.io/blog/theme/js/zooming.min.js"></script>
    
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <!--
  _   _ _       _     _   _           _     _      
 | \ | (_) __ _| |__ | |_| |_   _ ___(_) __| | ___ 
 |  \| | |/ _` | '_ \| __| | | | / __| |/ _` |/ _ \
 | |\  | | (_| | | | | |_| | |_| \__ \ | (_| |  __/
 |_| \_|_|\__, |_| |_|\__|_|\__, |___/_|\__,_|\___|
          |___/             |___/                  
-->
    <div class="container-fluid">
        <div class="row">
            <!-- Fixed nav section -->
            <div class="about col-sm-12 col-md-3 col-lg-2">
                <nav class="navbar navbar-fixed-side sticky-top row">
                    <img src="https://nightlyside.github.io/blog/images/avatar.png" alt="Alexandre Froehlich" />
                    <h2 class="col-sm-12"><a href="https://nightlyside.github.io/blog">Alexandre Froehlich</a></h2>
                    <p class="col-sm-12">
                        Hobbyist programmer. Petit développeur indépendant (aka.
                        Nightlyside) dont le rêve est d’être capable de publier un projet
                        terminé. Actuellement étudiant à l'ENSTA Bretagne
                    </p>

                    <!-- Navigation -->
                    <ul class="nav-list">
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/blog">Accueil</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/blog/files/cv.pdf">CV</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/blog/categories">Catégories</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/blog/archives">Archives</a>
                        </li>
                        <li class="nav-item">
                            <span class="nav-item-separator">//</span><a href="https://nightlyside.github.io/blog">À propos</a>
                        </li>
                    </ul>

                    <!-- Social links -->
                    <ul class="social">
                        <a href="https://github.com/nightlyside">
                            <li><i class="fab fa-github-square"></i></li>
                        </a>
                        <a href="https://www.linkedin.com/in/alexandre-f-1102298a">
                            <li><i class="fab fa-linkedin"></i></li>
                        </a>
                        <a href="https://twitter.com/froalexandre">
                            <li><i class="fab fa-twitter-square"></i></li>
                        </a>
                        <a href="https://reddit.com/u/nightlyside">
                            <li><i class="fab fa-reddit-square"></i></li>
                        </a>
                    </ul>
                </nav>
            </div>
            <!-- Main content -->
            <div class="col-sm-12 col-md-9 col-lg-10 main">
    <img class="featured_image" src="https://nightlyside.github.io/blog//images/BTC/lettre_cryptee.jpg" alt="Image de l'article">
                 <div class="container content">
                    <!-- Insert content here -->
<h1 class="title">[BTC] Warm Up - WriteUp</h1>
<p class="sous-titre">
    <span class="date-poste">Posté le dim. 05 janvier 2020 dans <a href="category/writeups.html">writeups</a></span> <br>
    <span class="temps-lecture">Temps de lecture : 3 minutes</span>
</p>
<hr>
<p>Lettre de M. X :</p>
<p>&Agrave; ma ch&egrave;re famille,</p>
<p>Ave,</p>

<p>Si vous recevez cette lettre, c'est qu'il m'est arriv&eacute; quelque chose. J'imagine, avide d'argent comme vous &ecirc;tes, que vous souhaitez plut&ocirc;t mettre la main sur ma fortune plut&ocirc;t que de d&eacute;penser votre &eacute;nergie pour me retrouver. Cel&agrave; ne m'arrange pas car j'aimerai plut&ocirc;t &ecirc;tre secouru. Enfin, vous savez comme je suis pr&eacute;voyant, j'ai tout pr&eacute;vu.
</p>
<p>En &eacute;change de pr&eacute;venir les forces de l'ordre, je vous propose le contenu de mon portefeuille num&eacute;rique. Aujourd'hui, il devrait &ecirc;tre valoris&eacute; &agrave; plusieurs millions si le cours ne s'est pas effondr&eacute;.</p>
<p>Je vous l&egrave;gue cette cl&eacute; U.S.B o&ugrave; j'ai dissimul&eacute; plusieurs &eacute;nigmes menant &agrave; des framgents qui vous permettront de reconstituer ma cl&eacute; priv&eacute;e vous permettant d'acc&eacute;der &agrave; ce portefeuille. Pour aider les enqu&ecirc;teurs, j'y ai &eacute;galement introduis plusieurs &eacute;l&eacute;ments sur o&ugrave; je me trouvais et avec qui je me trouvais avant que cette cl&eacute; ne soit envoy&eacute;e. Pour &ecirc;tre s&ucirc;r que vous contactiez r&eacute;ellement les forces de l'ordre, toute information est cach&eacute;e. Je doute que vous parviendrez par vous-m&ecirc;mes &agrave; r&eacute;soudre une quelconque de ces &eacute;nigmes, alors entourez-vous des meilleurs enqu&ecirc;teurs.</p>
<p>Pour commencer, je vous propose de d&eacute;chiffrer le contenu du message que je vous ai laiss&eacute; (encrypted.txt). Sachez que C&eacute;sar, &agrave; son &eacute;poque, utilisait ce m&ecirc;me syst&egrave;me pour communiquer avec ses g&eacute;n&eacute;raux. Je n'ai pas chang&eacute; la cl&eacute;, mais l'alphabet est bien diff&eacute;rent. Et il pourrait bien &ecirc;tre juste sous vos yeux.</p>
<p>M. X</p>
<hr/>
<p>Le Challenge Break the Code est une comp&eacute;tition du type Capture The Flag (CTF) organis&eacute;e par <a href="https://www.soprasteria.com/fr">Sopra Steria</a> qui dure 1h30. Les &eacute;quipes des grandes &eacute;coles du bassin brestois s&rsquo;y affrontent sur des challenges informatiques. Ces challenges m&eacute;langent diff&eacute;rentes comp&eacute;tences telles que la programmation, l&rsquo;analyse de donn&eacute;e et la culture du num&eacute;rique. </p>
<h2 id="premiere analyse">Premi&egrave;re Analyse</h2>
<p>Ce premier exercice permettait pendant la comp&eacute;tition de d&eacute;bloquer les challenges suivants. Il &eacute;tait donc primordial de le r&eacute;ussir le plus rapidement possible de mani&egrave;re &agrave; gagner un maximum de temps et de points.</p>
<blockquote>
<p>Si vous voulez essayer par vous-m&ecirc;me, les fichiers de cet exercice sont <a href="https://nightlyside.github.io/blog/files/BTC/warm-up.zip">disponibles ici.</a>.</p>
</blockquote>
<p>Le contenu de l'exercice est compos&eacute; d'un fichier README.md et d'un texte encrypt&eacute; : </p>
<div class="highlight"><pre><span></span><code><span class="n">ZURAS</span> <span class="n">NLYUG</span> <span class="n">YEFPYIYPUG</span><span class="p">,</span> <span class="n">MY</span> <span class="n">HSPIY</span> <span class="n">FPY</span> <span class="n">CR</span> <span class="n">JRCQXXY</span> <span class="n">RQI</span> <span class="n">UYPGGQ</span> <span class="n">YXXY</span> <span class="n">CYCY</span> <span class="n">R</span> <span class="n">HYNLQJJUYU</span> <span class="n">NY</span> <span class="n">CYGGRKY</span><span class="p">,</span> <span class="n">N</span> <span class="n">YGI</span> <span class="n">DSPUFPSQ</span> <span class="n">MY</span> <span class="n">ASPG</span> <span class="n">JYXQNQIY</span> <span class="n">DYUGSEEYXXYCYEI</span><span class="p">.</span>

<span class="n">MY</span> <span class="n">GPQG</span> <span class="n">YCZYIY</span><span class="p">,</span> <span class="n">MY</span> <span class="n">EY</span> <span class="n">DYPB</span> <span class="n">HYASQXYU</span> <span class="n">R</span> <span class="n">CR</span> <span class="n">JRCQXXY</span> <span class="n">X</span> <span class="n">RJJRQUY</span> <span class="n">GPU</span> <span class="n">XRFPYXXY</span> <span class="n">MY</span> <span class="n">GPQG</span><span class="p">.</span>
<span class="n">CRQG</span> <span class="n">MY</span> <span class="n">GPQG</span> <span class="n">RPMSPUH</span> <span class="n">LPQ</span> <span class="n">QENRDRZXY</span> <span class="n">HY</span> <span class="n">CY</span> <span class="n">XQZYUYU</span> <span class="n">HY</span> <span class="n">X</span> <span class="n">YEHUSQI</span> <span class="n">SP</span> <span class="n">MY</span> <span class="n">GPQG</span><span class="p">.</span> 
<span class="n">DSPU</span> <span class="n">NSEARQENUY</span> <span class="n">CR</span> <span class="n">JRCQXXY</span> <span class="n">HY</span> <span class="k">C</span> <span class="n">RQHYU</span> <span class="n">YI</span> <span class="n">HY</span> <span class="n">JQERENYU</span> <span class="n">X</span> <span class="n">YEFPYIY</span> <span class="n">DSPU</span> <span class="n">CY</span> <span class="n">UYIUSPAYU</span><span class="p">,</span> <span class="n">M</span> <span class="n">RQ</span> <span class="n">HQGGQCPXYU</span> <span class="n">FPRIUY</span> <span class="n">JURKCYEIG</span> <span class="n">HY</span> <span class="n">NXY</span> <span class="n">DYUCYIIREI</span> <span class="n">HY</span> <span class="n">UYNSEGIQIPYU</span> <span class="n">XR</span> <span class="n">NXY</span> <span class="n">JQERXY</span><span class="p">.</span>
<span class="n">NYG</span> <span class="n">JURKCYEIG</span> <span class="n">GSEI</span> <span class="n">NSEIYEPG</span> <span class="n">DRU</span> <span class="n">XYG</span> <span class="n">YEQKCYG</span> <span class="n">DUYGYEIYG</span> <span class="n">HREG</span> <span class="n">XR</span> <span class="n">NXY</span> <span class="n">PGZ</span> <span class="n">FPY</span> <span class="n">MY</span> <span class="n">ASPG</span> <span class="n">RQ</span> <span class="n">RHUYGGYY</span><span class="p">.</span>
<span class="n">DSPU</span> <span class="n">ASPG</span> <span class="n">RQHYT</span> <span class="n">HREG</span> <span class="n">X</span> <span class="n">YEFPYIY</span><span class="p">,</span> <span class="n">M</span> <span class="n">RQ</span> <span class="n">YKRXYCYEI</span> <span class="n">HQGGQCPXYU</span> <span class="n">XY</span> <span class="n">XQYP</span><span class="p">,</span> <span class="n">X</span> <span class="n">QHYEIQIY</span> <span class="n">YI</span> <span class="n">XY</span> <span class="n">EPCYUS</span> <span class="n">HY</span> <span class="n">IYXYDLSEY</span> <span class="n">HY</span> <span class="n">XR</span> <span class="n">DYUGSEEY</span> <span class="n">RAYN</span> <span class="n">FPQ</span> <span class="n">M</span> <span class="n">RARQG</span> <span class="n">UYEHYT</span> <span class="n">ASPG</span><span class="p">.</span>

<span class="n">XR</span> <span class="n">NXY</span> <span class="n">PGZ</span> <span class="n">YGI</span> <span class="n">AYUUSPQXXYY</span> <span class="n">ASQNQ</span> <span class="n">XY</span> <span class="n">JXRK</span> <span class="n">DYUCYIIREI</span> <span class="n">HY</span> <span class="n">X</span> <span class="n">SPAUQU</span> <span class="n">SDYEILRIDREHSURZSB</span><span class="p">.</span>

<span class="n">ESIY</span> <span class="p">:</span> <span class="n">NYNQ</span> <span class="n">YGI</span> <span class="n">XR</span> <span class="n">UYDSEGY</span> <span class="n">FPY</span> <span class="n">ASPG</span> <span class="n">HYAYT</span> <span class="n">HSEEYU</span> <span class="n">RP</span> <span class="n">MPKY</span><span class="p">,</span> <span class="n">NY</span> <span class="n">JXRK</span> <span class="n">DYUCYI</span> <span class="n">YKRXYCYEI</span> <span class="n">HY</span> <span class="n">HYAYUSPQXXYU</span> <span class="n">XY</span> <span class="n">JQNLQYU</span> <span class="n">TQD</span> <span class="n">PGZNSEIYEIG</span><span class="p">.</span>
</code></pre></div>
<p>La suite du fichier README nous explique comment fonctionne le chiffrement par substitution. Si vous ne savez pas ce que c'est je vous invite &agrave; lire <a href="http://bibmath.net/crypto/index.php?action=affiche&amp;quoi=substi/defsub">cet article</a>. Ensuite est venue ma premi&egrave;re erreur. Le document parle de chiffrement par d&eacute;calage d'alphabet, j'ai &eacute;videmment pens&eacute; tout de suite au <a href="https://fr.wikipedia.org/wiki/Chiffrement_par_d%C3%A9calage">chiffre de C&eacute;sar</a>. </p>
<p><strong>Petite astuce</strong> : pour cracker un code chiffr&eacute; par d&eacute;calage du type chiffre de C&eacute;sar, de nombreux sites web permettent de "bruteforcer" le code. Vous pourrez par exemple prendre <a href="https://www.dcode.fr/chiffre-cesar">dcode.fr</a>.</p>
<p>En testant le code crypt&eacute; ci-dessus sur ces sites on ne trouve rien de coh&eacute;rent, rien de lisible. C'est l&agrave; que j'ai rep&eacute;r&eacute; mon erreur.</p>
<h2 id="deuxieme analyse et implementation">Deuxi&egrave;me analyse et impl&eacute;mentation</h2>
<p>Comment faire pour cracker un code chiffr&eacute; par substitution lorsqu'on ne connait par le nouvel alphabet ? C'est simple si le texte est assez long (et c'est le cas ici), on a juste besoin de connaitre la <a href="https://fr.wikipedia.org/wiki/Fr%C3%A9quence_d%27apparition_des_lettres_en_fran%C3%A7ais">fr&eacute;quence d'apparition des lettres en fran&ccedil;ais</a>.</p>
<h3 id="affichage">Affichage</h3>
<p>De mani&egrave;re na&iuml;ve, le plus simple pour trouver un message est d'afficher graphiquement ce que l'on a d&eacute;j&agrave; trouv&eacute;. Pour ce faire, on repr&eacute;sentera les lettres que l'on a d&eacute;j&agrave; trouv&eacute;. Les caract&egrave;res sp&eacute;ciaux tels que l'espace, les apostrophes seront aussi repr&eacute;sent&eacute;s tels quels. Enfin les caract&egrave;re que l'on ne connait pas seront remplac&eacute;s par des _.</p>
<p>Au point de vue code python cela donne ceci :</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">affiche_decrypt</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">trouve</span><span class="o">=</span><span class="p">{}):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
        <span class="c1"># Si on connait la traduction</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">trouve</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">trouve</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
        <span class="c1"># Si le caract&egrave;re fait partie des sp&eacute;ciaux</span>
        <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">" "</span><span class="p">,</span> <span class="s2">"."</span><span class="p">,</span> <span class="s2">","</span><span class="p">,</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s2">":"</span><span class="p">]:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">char</span>
        <span class="c1"># Sinon on ne le connait pas</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="s2">"_"</span>
    <span class="c1"># On retourne le texte formatt&eacute;</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div>
<p>On n'oublie juste pas de prendre en compte le fait que <code>trouve</code> est un dictionnaire dont chaque cl&eacute; correspond &agrave; la lettre substitu&eacute;e.</p>
<h3 id="remplissage du dictionnaire">Remplissage du dictionnaire</h3>
<p>Pour savoir quelle lettre est la plus fr&eacute;quente dans le message, on cr&eacute;e une petite fonction python :</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">occurrences</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="c1"># On cr&eacute;e le dictionnaire des occurences</span>
    <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Pour chaque lettre dans le message</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
        <span class="c1"># S'il s'agit bien d'une lettre</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">" "</span><span class="p">,</span> <span class="s2">"."</span><span class="p">,</span> <span class="s2">","</span><span class="p">,</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s2">":"</span><span class="p">]:</span>
            <span class="c1"># Si on a d&eacute;j&agrave; cr&eacute;e une occurence</span>
            <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="nb">dict</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">dict</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># On retourne les lettres tri&eacute;es par occurrences</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">dict</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>Par exemple pour le message crypt&eacute; donn&eacute; on obtient :</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="s1">'Y'</span><span class="p">,</span> <span class="s1">'R'</span><span class="p">,</span> <span class="s1">'U'</span><span class="p">,</span> <span class="s1">'G'</span><span class="p">,</span> <span class="s1">'X'</span><span class="p">,</span> <span class="s1">'Q'</span><span class="p">,</span> <span class="s1">'P'</span><span class="p">,</span> <span class="s1">'E'</span><span class="p">,</span> <span class="s1">'I'</span><span class="p">,</span> <span class="s1">'S'</span><span class="p">,</span> <span class="s1">'H'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">,</span> <span class="s1">'N'</span><span class="p">,</span> <span class="s1">'D'</span><span class="p">,</span> <span class="s1">'A'</span><span class="p">,</span> <span class="s1">'J'</span><span class="p">,</span> <span class="s1">'M'</span><span class="p">,</span> <span class="s1">'F'</span><span class="p">,</span> <span class="s1">'K'</span><span class="p">,</span> <span class="s1">'Z'</span><span class="p">,</span> <span class="s1">'L'</span><span class="p">,</span> <span class="s1">'T'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">]</span>
</code></pre></div>
<p>Ainsi en essayant <code>Y=E</code>, <code>R=A</code>, <code>U=I</code>, <code>G=S</code>, <code>X=N</code> sur le message crypt&eacute; on obtient : </p>
<div class="highlight"><pre><span></span><code><span class="n">_IA__</span> <span class="n">__EIS</span> <span class="n">E___E_E_IS</span><span class="p">,</span> <span class="n">_E</span> <span class="n">____E</span> <span class="n">__E</span> <span class="n">_A</span> <span class="n">_A__NNE</span> <span class="n">A__</span> <span class="n">IE_SS_</span> <span class="n">ENNE</span> <span class="n">_E_E</span> <span class="n">A</span> <span class="n">_E_____IEI</span> <span class="n">_E</span> <span class="n">_ESSA_E</span><span class="p">,</span> <span class="n">_</span> <span class="n">ES_</span> <span class="n">___I____</span> <span class="n">_E</span> <span class="n">___S</span> <span class="n">_EN____E</span> <span class="n">_EIS___ENNE_E__</span><span class="p">.</span>

<span class="n">_E</span> <span class="n">S__S</span> <span class="n">E__E_E</span><span class="p">,</span> <span class="n">_E</span> <span class="n">_E</span> <span class="n">_E__</span> <span class="n">_E___NEI</span> <span class="n">A</span> <span class="n">_A</span> <span class="n">_A__NNE</span> <span class="n">N</span> <span class="n">A__A_IE</span> <span class="n">S_I</span> <span class="n">NA__ENNE</span> <span class="n">_E</span> <span class="n">S__S</span><span class="p">.</span>
<span class="n">_A_S</span> <span class="n">_E</span> <span class="n">S__S</span> <span class="n">A____I_</span> <span class="n">___</span> <span class="n">___A_A_NE</span> <span class="n">_E</span> <span class="n">_E</span> <span class="n">N__EIEI</span> <span class="n">_E</span> <span class="n">N</span> <span class="n">E__I___</span> <span class="n">__</span> <span class="n">_E</span> <span class="n">S__S</span><span class="p">.</span>
<span class="n">___I</span> <span class="n">____A___IE</span> <span class="n">_A</span> <span class="n">_A__NNE</span> <span class="n">_E</span> <span class="n">_</span> <span class="n">A__EI</span> <span class="n">E_</span> <span class="n">_E</span> <span class="n">___A__EI</span> <span class="n">N</span> <span class="n">E___E_E</span> <span class="n">___I</span> <span class="n">_E</span> <span class="n">IE_I___EI</span><span class="p">,</span> <span class="n">_</span> <span class="n">A_</span> <span class="n">__SS___NEI</span> <span class="n">__A_IE</span> <span class="n">_IA__E__S</span> <span class="n">_E</span> <span class="n">_NE</span> <span class="n">_EI_E__A__</span> <span class="n">_E</span> <span class="n">IE___S____EI</span> <span class="n">NA</span> <span class="n">_NE</span> <span class="n">___ANE</span><span class="p">.</span>
<span class="n">_ES</span> <span class="n">_IA__E__S</span> <span class="n">S___</span> <span class="n">____E__S</span> <span class="n">_AI</span> <span class="n">NES</span> <span class="n">E____ES</span> <span class="n">_IESE__ES</span> <span class="n">_A_S</span> <span class="n">NA</span> <span class="n">_NE</span> <span class="n">_S_</span> <span class="n">__E</span> <span class="n">_E</span> <span class="n">___S</span> <span class="n">A_</span> <span class="n">A_IESSEE</span><span class="p">.</span>
<span class="n">___I</span> <span class="n">___S</span> <span class="n">A__E_</span> <span class="n">_A_S</span> <span class="n">N</span> <span class="n">E___E_E</span><span class="p">,</span> <span class="n">_</span> <span class="n">A_</span> <span class="n">E_ANE_E__</span> <span class="n">__SS___NEI</span> <span class="n">NE</span> <span class="n">N_E_</span><span class="p">,</span> <span class="n">N</span> <span class="n">__E____E</span> <span class="n">E_</span> <span class="n">NE</span> <span class="n">___EI_</span> <span class="n">_E</span> <span class="n">_ENE____E</span> <span class="n">_E</span> <span class="n">NA</span> <span class="n">_EIS___E</span> <span class="n">A_E_</span> <span class="n">___</span> <span class="n">_</span> <span class="n">A_A_S</span> <span class="n">IE__E_</span> <span class="n">___S</span><span class="p">.</span>

<span class="n">NA</span> <span class="n">_NE</span> <span class="n">_S_</span> <span class="n">ES_</span> <span class="n">_EII___NNEE</span> <span class="n">_____</span> <span class="n">NE</span> <span class="n">_NA_</span> <span class="n">_EI_E__A__</span> <span class="n">_E</span> <span class="n">N</span> <span class="n">___I_I</span> <span class="n">__E___A__A___IA___</span><span class="p">.</span>

<span class="n">___E</span> <span class="p">:</span> <span class="n">_E__</span> <span class="n">ES_</span> <span class="n">NA</span> <span class="n">IE___SE</span> <span class="n">__E</span> <span class="n">___S</span> <span class="n">_E_E_</span> <span class="n">____EI</span> <span class="n">A_</span> <span class="n">___E</span><span class="p">,</span> <span class="n">_E</span> <span class="n">_NA_</span> <span class="n">_EI_E_</span> <span class="n">E_ANE_E__</span> <span class="n">_E</span> <span class="n">_E_EI___NNEI</span> <span class="n">NE</span> <span class="n">_____EI</span> <span class="n">___</span> <span class="n">_S_____E__S</span><span class="p">.</span>
</code></pre></div>
<p>C'est effectivement un bon premier d&eacute;part. Certes, cela ne marche pas pour toutes les lettres cependant on peut commencer &agrave; deviner les mots. De plus s'agissant d'une lettre on devine que le mot du dernier paragraphe <code>ESIY</code> : correspond &agrave; <code>NOTE</code> : en essayant petit &agrave; petit on arrive &agrave; remplir le dictionnaire :</p>
<div class="highlight"><pre><span></span><code><span class="n">trouve</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"Y"</span><span class="p">:</span><span class="s2">"E"</span><span class="p">,</span> <span class="s2">"R"</span><span class="p">:</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"U"</span><span class="p">:</span><span class="s2">"R"</span><span class="p">,</span> <span class="s2">"G"</span><span class="p">:</span><span class="s2">"S"</span><span class="p">,</span> <span class="s2">"X"</span><span class="p">:</span><span class="s2">"L"</span><span class="p">,</span> <span class="s2">"E"</span><span class="p">:</span><span class="s2">"N"</span><span class="p">,</span> <span class="s2">"S"</span><span class="p">:</span><span class="s2">"O"</span><span class="p">,</span> <span class="s2">"I"</span><span class="p">:</span><span class="s2">"T"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">:</span><span class="s2">"M"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">:</span><span class="s2">"P"</span><span class="p">,</span> <span class="s2">"H"</span><span class="p">:</span><span class="s2">"D"</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span><span class="s2">"U"</span><span class="p">,</span> <span class="s2">"J"</span><span class="p">:</span><span class="s2">"F"</span><span class="p">,</span> <span class="s2">"Q"</span><span class="p">:</span><span class="s2">"I"</span><span class="p">,</span> <span class="s2">"N"</span><span class="p">:</span><span class="s2">"C"</span><span class="p">,</span> <span class="s2">"F"</span><span class="p">:</span><span class="s2">"Q"</span><span class="p">,</span> <span class="s2">"A"</span><span class="p">:</span><span class="s2">"V"</span><span class="p">,</span> <span class="s2">"T"</span><span class="p">:</span><span class="s2">"Z"</span><span class="p">,</span> <span class="s2">"L"</span><span class="p">:</span><span class="s2">"H"</span><span class="p">,</span> <span class="s2">"K"</span><span class="p">:</span><span class="s2">"G"</span><span class="p">,</span> <span class="s2">"Z"</span><span class="p">:</span><span class="s2">"B"</span><span class="p">,</span> <span class="s2">"M"</span><span class="p">:</span><span class="s2">"J"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="s2">"X"</span><span class="p">}</span>
</code></pre></div>
<p>Ce qui nous donne enfin le message d&eacute;crypt&eacute; : </p>
<div class="highlight"><pre><span></span><code><span class="n">BRAVO</span> <span class="n">CHERS</span> <span class="n">ENQUETEURS</span><span class="p">,</span> <span class="n">JE</span> <span class="n">DOUTE</span> <span class="n">QUE</span> <span class="n">MA</span> <span class="n">FAMILLE</span> <span class="n">AIT</span> <span class="n">REUSSI</span> <span class="n">ELLE</span> <span class="n">MEME</span> <span class="n">A</span> <span class="n">DECHIFFRER</span> <span class="n">CE</span> <span class="n">MESSAGE</span><span class="p">,</span> <span class="k">C</span> <span class="n">EST</span> <span class="n">POURQUOI</span> <span class="n">JE</span> <span class="n">VOUS</span> <span class="n">FELICITE</span> <span class="n">PERSONNELLEMENT</span><span class="p">.</span>

<span class="n">JE</span> <span class="n">SUIS</span> <span class="n">EMBETE</span><span class="p">,</span> <span class="n">JE</span> <span class="n">NE</span> <span class="n">PEUX</span> <span class="n">DEVOILER</span> <span class="n">A</span> <span class="n">MA</span> <span class="n">FAMILLE</span> <span class="n">L</span> <span class="n">AFFAIRE</span> <span class="n">SUR</span> <span class="n">LAQUELLE</span> <span class="n">JE</span> <span class="n">SUIS</span><span class="p">.</span>
<span class="n">MAIS</span> <span class="n">JE</span> <span class="n">SUIS</span> <span class="n">AUJOURD</span> <span class="n">HUI</span> <span class="n">INCAPABLE</span> <span class="n">DE</span> <span class="n">ME</span> <span class="n">LIBERER</span> <span class="n">DE</span> <span class="n">L</span> <span class="n">ENDROIT</span> <span class="n">OU</span> <span class="n">JE</span> <span class="n">SUIS</span><span class="p">.</span>
<span class="n">POUR</span> <span class="n">CONVAINCRE</span> <span class="n">MA</span> <span class="n">FAMILLE</span> <span class="n">DE</span> <span class="n">M</span> <span class="n">AIDER</span> <span class="n">ET</span> <span class="n">DE</span> <span class="n">FINANCER</span> <span class="n">L</span> <span class="n">ENQUETE</span> <span class="n">POUR</span> <span class="n">ME</span> <span class="n">RETROUVER</span><span class="p">,</span> <span class="n">J</span> <span class="n">AI</span> <span class="n">DISSIMULER</span> <span class="n">QUATRE</span> <span class="n">FRAGMENTS</span> <span class="n">DE</span> <span class="n">CLE</span> <span class="n">PERMETTANT</span> <span class="n">DE</span> <span class="n">RECONSTITUER</span> <span class="n">LA</span> <span class="n">CLE</span> <span class="n">FINALE</span><span class="p">.</span>
<span class="n">CES</span> <span class="n">FRAGMENTS</span> <span class="n">SONT</span> <span class="n">CONTENUS</span> <span class="n">PAR</span> <span class="n">LES</span> <span class="n">ENIGMES</span> <span class="n">PRESENTES</span> <span class="n">DANS</span> <span class="n">LA</span> <span class="n">CLE</span> <span class="n">USB</span> <span class="n">QUE</span> <span class="n">JE</span> <span class="n">VOUS</span> <span class="n">AI</span> <span class="n">ADRESSEE</span><span class="p">.</span>
<span class="n">POUR</span> <span class="n">VOUS</span> <span class="n">AIDEZ</span> <span class="n">DANS</span> <span class="n">L</span> <span class="n">ENQUETE</span><span class="p">,</span> <span class="n">J</span> <span class="n">AI</span> <span class="n">EGALEMENT</span> <span class="n">DISSIMULER</span> <span class="n">LE</span> <span class="n">LIEU</span><span class="p">,</span> <span class="n">L</span> <span class="n">IDENTITE</span> <span class="n">ET</span> <span class="n">LE</span> <span class="n">NUMERO</span> <span class="n">DE</span> <span class="n">TELEPHONE</span> <span class="n">DE</span> <span class="n">LA</span> <span class="n">PERSONNE</span> <span class="n">AVEC</span> <span class="n">QUI</span> <span class="n">J</span> <span class="n">AVAIS</span> <span class="n">RENDEZ</span> <span class="n">VOUS</span><span class="p">.</span>

<span class="n">LA</span> <span class="n">CLE</span> <span class="n">USB</span> <span class="n">EST</span> <span class="n">VERROUILLEE</span> <span class="n">VOICI</span> <span class="n">LE</span> <span class="n">FLAG</span> <span class="n">PERMETTANT</span> <span class="n">DE</span> <span class="n">L</span> <span class="n">OUVRIR</span> <span class="n">OPENTHATPANDORABOX</span><span class="p">.</span>

<span class="n">NOTE</span> <span class="p">:</span> <span class="n">CECI</span> <span class="n">EST</span> <span class="n">LA</span> <span class="n">REPONSE</span> <span class="n">QUE</span> <span class="n">VOUS</span> <span class="n">DEVEZ</span> <span class="n">DONNER</span> <span class="n">AU</span> <span class="n">JUGE</span><span class="p">,</span> <span class="n">CE</span> <span class="n">FLAG</span> <span class="n">PERMET</span> <span class="n">EGALEMENT</span> <span class="n">DE</span> <span class="n">DEVEROUILLER</span> <span class="n">LE</span> <span class="n">FICHIER</span> <span class="n">ZIP</span> <span class="n">USBCONTENTS</span><span class="p">.</span>
</code></pre></div>
<p>On r&eacute;cup&egrave;re finalement le flag qui est <code>OPENTHATPANDORABOX</code>.</p>
<h2 id="conclusion_1">Conclusion</h2>
<p>Ce challenge permettait de d&eacute;bloquer les 7 derniers de la comp&eacute;tition. Leur r&eacute;solution &eacute;tait primoridiale. Le dossier <em>usb_contents</em> pr&eacute;sent sur la cl&eacute; se d&eacute;v&eacute;rouille ainsi avec le flag obtenu.
Les organisateurs ont finalement distribu&eacute; le flag aux autres &eacute;quipes en donnant un indice qui me fait penser encore que les combinaisons les plus simples sont malheureusement encore (trop) souvent utilis&eacute;es dans les concours. Si vous remplacez "ABCDEFG..." par "AZERTYU..." vous obtenez le d&eacute;chiffrage.
Mon erreur aura &eacute;t&eacute; ici d'avoir perdu trop de temps en pensant qu'il n'y avait pas de pattern possible pour la substitution. Je m'en souviendrais !</p>
<p>PS : pour les flemmards voici une fonction python qui vous sort la prochaine lettre la plus fr&eacute;quente en fonction du message et de ce que vous avez d&eacute;j&agrave; devin&eacute; : </p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">prochaine_lettre</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">trouve</span><span class="p">):</span>
    <span class="c1"># On recupere les occurences</span>
    <span class="n">occ</span> <span class="o">=</span> <span class="n">occurrences</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="c1"># Pour chaque lettre &agrave; partir de la plus r&eacute;currente</span>
    <span class="k">for</span> <span class="n">lettre</span> <span class="ow">in</span> <span class="n">occ</span><span class="p">:</span>
        <span class="c1"># Si la lettre n'a pas &eacute;t&eacute; trouv&eacute;e</span>
        <span class="k">if</span> <span class="n">lettre</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">trouve</span><span class="p">:</span>
            <span class="c1"># On retourne la lettre</span>
            <span class="k">return</span> <span class="n">lettre</span>
    <span class="c1"># Toutes les lettres ont &eacute;t&eacute; test&eacute;es</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
<p>PPS: pour les plus flemmard vous pouvez retrouver le code au complet <a href="https://nightlyside.github.io/blog/files/BTC/pandora_box.py">ici</a>.</p>

                    <!-- Footer -->
                    <hr>
                    <div class="container">
                        <div class="row justify-content-sm-center">
                            <p>© 2020 Alexandre Froehlich</p>
                        </div>
                    </div>
                 </div>
            </div>
        </div>
    </div>
    <script>
      // Listen to images after DOM content is fully loaded
      document.addEventListener('DOMContentLoaded', function () {
        new Zooming({
          // options...
        }).listen('.img-zoomable')
      })
    </script>
</body>

</html>